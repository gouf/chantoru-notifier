# Build Environment
build_environment: Ubuntu 12.04

# language setting
language: ruby

# version numbers
rvm:
 - 2.1.1

env:
  global:
    - EB_TOOLS_DIR=/tmp/eb_tools
    - EB_VERSION=AWS-ElasticBeanstalk-CLI-2.6.3
    - EB_TOOLS=$EB_TOOLS_DIR/$EB_VERSION
    - secure: Vy2Aw5JC8NRJ4B3sgljDecZkHNWZBWDde+4RfvEoHcaxPGLdO7Gx1HJAvbcafE7GQjCsLtG47yX8oW9PiPA56v8M+LePCA6b5V6Urwv5JF50lUQ72JR2Eegl44THqPF9wkr9odIGzm/o6Fvd0GrwtSAoV8zGySq5m/RfRK1fc7Tr1jNEYhorywRz59geS34JvHhspUXPYYSHLJJK3hNV/5cAi9et+H/9Uw7TBlaqTyINQMhX/G0nXmOG+lFjGR4ESSub2KEhu13lqGhjd1vnyu3urgpN7FhtZvo0X5TUZnRwc9STo31a0dCNvoddbjgbugo24x3jJQgVjppZ/TyEaQ==
    - secure: sKcMxniyJq7AK+E44n2XidZz2MgidSOBlk2OzlmxnwPADtNXJYxyw2rdLmudQiBhb7cyqmgpNCtxTXOzznLxp64HK6knK44tfNt+fA841irRE738+YgyfBMAUrjKvJF+bf8ZE/A+19zAb+3lj2DKqkdjoDW1rBbGuCzGzBLDUsZTwxvTSfQ7JHBuxOGGpqIHhjFihUBLqbN5pl/pb4B2PEHF1F+xfmmNVzdyB8ZNHH5JB7IWUrLL+l+qpExszokxuEgC8qRvs79Dz/zjchrDV5Z0uNt1P47Xu32n2nsxfSzpF4JvEsbTQ6s9X/ZXVv7G/E2quspx+AdbKscLWx8Qeg==

before_install:
  - if [ ! -e $EB_TOOLS ]; then wget -q -O /tmp/eb.zip https://s3.amazonaws.com/elasticbeanstalk/cli/$EB_VERSION.zip && mkdir -p $EB_TOOLS_DIR && unzip /tmp/eb.zip -d $EB_TOOLS_DIR; fi

before_script:
  - mkdir -p ~/.elasticbeanstalk
  - echo 'AWSAccessKeyId=AKIAIYZILLGEQKTRH5VA' >> ~/.elasticbeanstalk/aws_credential_file
  - echo 'AWSSecretKey='$AWSSecretKey >> ~/.elasticbeanstalk/aws_credential_file

script:
  - mkdir -p .elasticbeanstalk
  - cp shippable_eb_config .elasticbeanstalk/config

after_success:
  - $EB_TOOLS_DIR/AWSDevTools/Linux/AWSDevTools-RepositorySetup.sh
  - export PATH=$PATH:$EB_TOOLS/eb/linux/python2.7/ && virtualenv ve && source ve/bin/activate && pip install boto==2.14.0 && eb push
